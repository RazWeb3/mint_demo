<!--
目的・役割: XRPLutter NFT Kit SDKの要件定義書。システムの目的、スコープ、機能/非機能要件、制約、テスト方針を整理する。
作成日: 2025/11/08
-->

# XRPLutter NFT Kit SDK 要件定義書

## 1. 概要（目的）
XRPLutter NFT Kit SDKは、Flutter開発者（クリエイター）がXRPL（XRP Ledger）上でNFT（Non-Fungible Token）の発行・送付・バーンを安全かつ簡易に扱えるようにするための開発者向けツールキットです。将来的に、コードを書けないユーザーが直感的にNFT機能を利用できるノーコード/ローコードのアプリビルダーの基盤となることを目指します。

## 2. スコープ
- 対象: Flutterでアプリを作るクリエイターが自分のアプリへNFT機能を組み込むためのSDK。
- 提供機能（初期リリース）:
  - ウォレット連携（接続/切断、署名委任）
  - NFTの発行（ミント）
  - NFTの送付（所有権移転の抽象化）
  - NFTのバーン（焼却）
- 非対象（アプリ側で実装する領域）:
  - アプリ内通貨の管理、価格設定、マッチング、エスクロー等の売買ロジック
  - アイテムの使用結果や合成/進化のルールなど、各アプリ固有のゲーム/サービスロジック

## 3. 利用シーン（例）
- ユーザー同士のNFT送付（ギフト/トレード）
- アプリ内通貨によるNFT売買（送付機能と組み合わせて実現）
- アイテムの消費（バーンによる消費表現）
- 合成・進化（元NFTをバーンして新NFTを再生成）

## 4. 機能要件
### 4.1 ウォレット連携
- 外部ウォレット（例:Xumm）と安全に接続/切断できること
- 秘密鍵はSDKで保持せず、すべての署名は外部ウォレットに委任すること
- 接続中のアカウント情報の取得、署名要求の生成/送信

### 4.2 NFT発行（ミント）
- 必要なパラメータ（例: メタデータURI、Taxon、オプションのTransferFee）でNFTを発行できること
- 成功/失敗の結果（NFT ID、トランザクションID等）を返せること
- 入力検証（必須項目、形式）とエラーフィードバック

### 4.3 NFT送付（所有権移転の抽象化）
- 送付先アドレスを指定して、NFTの所有権移転に必要なXRPL取引（例: NFTokenCreateOffer / NFTokenAcceptOffer）を抽象化して扱えること
- ギフト（0価格）や売買（価格あり）などのユースケースに対応可能な設計（価格や通貨の扱い自体はアプリ側）
- 受取側の承認（Accept）が必要なフローを分かりやすく提示

### 4.4 NFTバーン（焼却）
- 所有者がNFTを破棄するための取引（例: NFTokenBurn）を生成・実行できること
- バーン結果（トランザクションID等）の取得

## 5. 非機能要件
- セキュリティ: 秘密鍵非保持、入力検証、署名委任、安全な通信
- 信頼性: 明確なエラーハンドリング、再試行ポリシー、ロギング
- パフォーマンス: 一般的なネットワーク待ち時間を考慮しつつUXを損なわない設計
- 互換性: Flutter（Dart 3系）に対応、モバイル/Webでの利用を想定
- 可観測性: ログ/イベントフックにより外部で監視可能

## 6. 制約・前提
- XRPLネットワークへの接続（Mainnet/Testnet）
- 外部ウォレット（例:Xumm）の利用が前提
- ネットワーク状態やノード負荷による遅延の可能性
- SDKはXRPLのNFT仕様（NFToken*トランザクション）に準拠

## 7. テスト方針
- 単体テスト: メソッド単位のロジック検証（引数検証、ペイロード生成、エラー処理）
- 統合テスト: ウォレット連携〜ミント/送付/バーンまでの連携確認（必要に応じてTestnet）
- サンプルアプリでの動作確認: Flutter製の最小アプリにSDKを組み込み、エンドユーザー視点のE2E検証

## 8. 成功基準
- 公開リポジトリで第三者がSDKを導入し、設定を行えば、ミント/送付/バーンまでを再現できること
- サンプルアプリのコードを参考に、最小構成の導入が可能であること

## 9. 法規制への配慮（ガイドライン）
- SDK自体はツールであり、資金移動等の主体ではないが、アプリ/プラットフォーム側は関連法規に準拠する必要がある
- 必要に応じてKYC/AMLのフックや利用制限を組み込める拡張性を確保
- ネットワーク負荷軽減のためのレート制限やキャッシュ戦略の検討

## 10. アウトオブスコープ
- アプリ内通貨の管理、決済、エスクロー、マーケットプレイス運営
- 合成/進化等のゲームルールの実装（SDKはミント/バーンのプリミティブ提供に限定）

## 11. リスクと対策
- 署名拒否/タイムアウト: リトライ指針とUX上の通知
- ネットワーク障害: 再試行、フォールバックノード、明示的なエラーメッセージ
- 仕様変更（XRPL側）: バージョニングと変更追従ポリシー

## 12. 依存関係
- XRPLノード（JSON-RPC/WebSocket/API）
- 外部ウォレット（例:Xumm）
- Flutter/DartのHTTP・暗号関連ライブラリ

## 13. 未確定事項/今後の検討
- 送付抽象化APIでの価格/通貨パラメータの扱いガイドライン
- サンプルアプリでのウォレット署名UX（Deep Link/QR等）
- メタデータのホスティング方法（IPFS等）の推奨